# RFI

Οι RFI επιθέσεις μπορούν να χρησιμοποιηθούν ώστε ο απιτηθέμενος να καταφέρει να εκτελέσει κώδικα στο αντίπαλο site. Ο κώδικας αυτός, προέρχεται από τον ίδιο, μέσω αρχείων που έχει ανεβάσει στο domain. Στο eclass τα διαθέσιμα μέρη για ανέβασμα αρχείων ήταν οι __Εργασίες__ και η __Ανταλλαγή Αρχείων__. Κανένα απο αυτά τα 2 modules δεν ήταν καλά προστατευμένο απο File Injections, καθώς ο χρήστης μπορούσε ανενόχλητος να ανεβάσει ό,τι τύπου αρχείο ήθελε, και στην συνέχεια να το εκτελέσει, πηγαίνοντας στο link του αρχείου, στο οποίο εκ πρώτης όψεως δεν είχε πρόσβαση.

Όμως, μέσω του κώδικα στο αρχείο `modules/dropbox/dropbox_init1.inc.php`, είδαμε πως τα αρχεία της ανταλλαγής αρχείων βρίσκονται στον φάκελο `courses/<course_id>/dropbox/`, επομένως μέσα από εκεί θα μπορούσαμε να εκτελέσουμε το αρχείο το οποίο ανεβάσαμε, μέσα στον server. 

Αντίστοιχα, τα αρχεία που ανεβάζουν οι χρήστες για τις εργασίες, βρίσκονται στον κατάλογο `courses/<course_id>/work/`.

Και στις 2 περιπτώσεις, για "ασφάλεια", τα αρχεία και οι φάκελοι στα οποία μπαίνουν, παίρνουν τυχαίο όνομα, που όμως δεν έχει καμία σημασία, εφόσον μπορούμε να περιηγηθούμε στο δέντρο των καταλόγων του site.

## Defence

Για να αντιμετωπιστεί το πρόβλημα που αναφέρθηκε παραπάνω, κάναμε τα εξής:

 - Δημιουργήσαμε ένα αρχείο `.htaccess`, το οποίο απενεργοποιούσε την δυνατότητα να φαίνεται το δέντρο των καταλόγων, και επομένως, σε συνδυασμό με το ότι τα ονόματα των φακέλων είναι τυχαία, ο αντίπαλος δεν θα μπορούσε να βρεί την τοποθεσία των αρχείων που ανέβασε ώστε να τα τρέξει.
 - Φιλτράραμε το ανέβασμα των αρχείων, ώστε να μην επιτρέπεται να ανέβουν αρχεία με suspicious καταλήξεις, όπως `.php`, `.js`, `.sh` κλπ, ώστε ακόμα και αν με κάποιον τρόπο ο αντίπαλος αποκτούσε πρόσβαση στον φάκελο, να μην μπορούσε να τρέξει τα αρχεία.

## Attack