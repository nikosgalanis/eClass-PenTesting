# Vulnerabilities

The following report states all the vunerabilities that were found in the website.

## XSS

Too many XSS holes were found in the eclass platform, as except of a few pages, the site was exposed to xss attacks. In a few places (mostly administrator pages), a q function was created, which was abbreviated to `htmlspecialchars ()`, but still, it was hardly used at all. The places were the defnce against xss attacks was poor were:

    - (Lesson) -> Discussion Areas -> New Topic -> "html" text option
    - (Lesson) -> File Exchange -> Upload a file with a description of a script
    - (Lesson) -> Remote Collaboration -> New message with script -> Send -> New message with any topic
    - Edit Profile -> Change name / surname
    - (admin) -> Course creation -> every user input
    - (admin) -> Course announcements -> every user input
    - (admin) -> User Management -> every user input
    - User creation -> username

## File Injections

In eclass the available pages for uploading files were __Work__ and __File Exchange__, both located in every course. Neither of these 2 modules was protected by File Injections, as the user could easily upload whatever type of file they wanted, and then execute it by going to the file link, which at first glance did not have access.

However, through the code in the file `modules/dropbox/dropbox_init1.inc.php`, we saw that the files of the file exchange are in the folder `courses/<course_id>/dropbox/`, so from this location we could run the file which we uploaded to the server.

Respectively, the files uploaded by users for the tasks are in the list `courses/<course_id>/work/`.

In both cases, for "security purposes", the files and folders in which they are inserted, get a random name, which, however, does not matter, as long as everyone can browse the tree of the site's directories. Also, this name is stored in the database, in the secret_direcotry field of the assignments table, to which we could gain access with some sql injection.

Local file injections can also be done on the site, if the opponent tries to include a file from our server from the url.

## SQL Injections

Sql injections can be used to access __data stored in the database__, such as a user's password (encrypted with md5), as well as the names of secret directories that will be useful to us for RFI attacks. Not many problems were found for SQL Injections on the site. The programmers who created it used techniques to prevent the user from entering SQL Queries, while in places that cannot be avoided there are functions that determine the form of the variables before passing through the queries. The main way to deal with the injections we observed was horizontal escape functions, but also the use of `intval ()` where the input was integer.


## CSRF

CSRF attacks can be useful for the opponent, if a user connected to the site clicks on a link that corresponds to a page that fills out a fake form that causes changes that the site should normally have requested. The eclass page had __absolutely none__ protection against CSRF attacks.


